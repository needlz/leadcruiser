= t('reports.excel_icon_alt') + ':'
=link_to image_tag("excel-icon.png",  alt: t('reports.excel_icon_alt'), width: 25, height: 25),
 reports_path(format: 'xls', firstDate: params[:firstDate], secondDate: params[:secondDate]),
 class: 'excel-icon'

%p.sorting-notice= t('reports.use_shift')
.clearfix
%table.table.table-hover
  %thead
    %tr
      - I18n.t('reports.lead.columns').values.each do |column_value|
        %th= column_value
  %tbody
    - @leads.each do |lead|
      - if lead.sold_responses.length == 0
        %tr
          %td= lead.id
          %td= lead.visitor_ip
          %td= lead.first_name
          %td= lead.last_name
          %td= lead.zip
          %td= lead.state.nil? ? lead.zip_code.try(:state) : lead.state
          %td= lead.email
          %td= (lead.details_pets.first.conditions? ? 'TRUE' : 'FALSE') if lead.details_pets.present?
          %td= lead.times_sold.nil? ? 0 : lead.times_sold
          %td= '$0.00'
          %td= ''
          %td= ''
          %td= lead.created_at
          %td= "tel:" + lead.day_phone
          %td= lead.details_pets.first.pet_name if lead.details_pets.present?
          %td= lead.details_pets.first.species if lead.details_pets.present?
          %td= lead.details_pets.first.breed if lead.details_pets.present?
          %td= (lead.details_pets.first.spayed_or_neutered? ? 'TRUE' : 'FALSE') if lead.details_pets.present?
          %td= lead.details_pets.first.birth_month if lead.details_pets.present?
          %td= lead.details_pets.first.birth_year if lead.details_pets.present?
          %td= lead.details_pets.first.gender if lead.details_pets.present?
          %td= lead.visitor.nil? ? '' : lead.visitor.session_hash
          %td= lead.visitor.nil? ? '' : lead.visitor.referring_url
          %td= lead.visitor.nil? ? '' : lead.visitor.landing_page
          %td= lead.visitor.nil? ? '' : lead.visitor.keywords
      - else
        - lead.sold_responses.each do |response|
          %tr
            %td= lead.id
            %td= lead.visitor_ip
            %td= lead.first_name
            %td= lead.last_name
            %td= lead.zip
            %td= lead.state.nil? ? lead.zip_code.try(:state) : lead.state
            %td= lead.email
            %td= (lead.details_pets.first.conditions? ? 'TRUE' : 'FALSE') if lead.details_pets
            %td= lead.times_sold.nil? ? 0 : lead.times_sold
            %td= '$' + lead.sold_po_price(response.purchase_order_id).to_s
            %td= lead.client_sold_to(response.client_name).try(:official_name)
            %td= lead.sold_type.exclusive_selling? ? 'Exclusive' : 'Shared'
            %td= lead.created_at
            %td= "tel:" + lead.day_phone
            %td= lead.details_pets.first.pet_name if lead.details_pets.present?
            %td= lead.details_pets.first.species if lead.details_pets.present?
            %td= lead.details_pets.first.breed if lead.details_pets.present?
            %td= (lead.details_pets.first.spayed_or_neutered? ? 'TRUE' : 'FALSE') if lead.details_pets.present?
            %td= lead.details_pets.first.birth_month if lead.details_pets.present?
            %td= lead.details_pets.first.birth_year if lead.details_pets.present?
            %td= lead.details_pets.first.gender if lead.details_pets.present?
            %td= lead.visitor.nil? ? '' : lead.visitor.session_hash
            %td= lead.visitor.nil? ? '' : lead.visitor.referring_url
            %td= lead.visitor.nil? ? '' : lead.visitor.landing_page
            %td= lead.visitor.nil? ? '' : lead.visitor.keywords

- if @leads.empty?
  .no-data
    = t('reports.lead.no_available_leads')

.col-md-12
  = will_paginate @leads, :renderer => BootstrapPagination::Rails

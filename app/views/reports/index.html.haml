.row.form-group
  .col-md-2
    %h2 Leads per day graph
  .col-md-9.choose-range
    = t('reports.choose_range')
    = t('reports.range_from')
    %input#graph-date-range-from
    = t('reports.range_to')
    %input#graph-date-range-to
    #leads_per_day{:style => "height: 400px; min-width: 500px;"}

.row.form-group
  .col-md-2
    %h2 Leads
  .col-md-12
    = t('reports.choose_range')
    = t('reports.range_from')
    %input#table-date-range-from
    = t('reports.range_to')
    %input#table-date-range-to

.lead-table.col-md-12
  = render 'leads'


:javascript
  $(function () {
    Highcharts.setOptions({
      global: {
        useUTC: false
      }
    });

    $('#leads_per_day').highcharts({
      chart: {
        type: 'line',
        zoomType: 'xy',
        alignTicks: false,
        plotBorderWidth: 2
      },
      title : {
        text: 'Leads per Day'
      },
      credits: {
        enabled: false
      },
      global: {
        useUTC: false
      },
      xAxis: {
        title: {
          text: 'Date'
        },
        type: 'datetime',
        dateTimeLabelFormats: {
          millisecond: '%e. %b',
          second: '%e. %b',
          minute: '%e. %b',
          hour: '%e. %b',
          day: '%e. %b',
          week: '%e. %b',
          month: '%b \'%y',
          year: '%Y'
        },
        startOnTick: true,
        endOnTick: true,
        showLastLabel: true
      },
      yAxis: {
        title: {
          text: 'Leads'
        }
      },
      legend: {
        enabled: false
      },
      tooltip: {
        formatter: function() {
          return Highcharts.dateFormat('%m/%e/%Y', new Date(this.x)) + '<br/>Leads: ' + this.y;
        }
      },
      series: [{
        name: 'Leads',
        color: 'rgba(223, 83, 83, 0.5)',
      }]
    });

    LeadStatisticGraph.show( #{@leads_per_day} );

    DatePicker.initializeForGraph();
    DatePicker.initializeForLeads();

    $('#graph-date-range-from').datetimepicker({
      timepicker: false,
      format: "Y-m-d",
      onClose: function(time, $input) {
        DatePicker.graph_date_range_from = $input.val();
        DatePicker.updateForGraph();
      },
      closeOnDateSelect: true
    });

    $('#graph-date-range-to').datetimepicker({
      timepicker:false,
      format: "Y-m-d",
      onClose: function(time, $input) {
        DatePicker.graph_date_range_to = $input.val();
        DatePicker.updateForGraph();
      },
      closeOnDateSelect: true
    });

    $('#table-date-range-from').datetimepicker({
      timepicker: false,
      format: "Y-m-d",
      onClose: function(time, $input) {
        DatePicker.table_date_range_from = $input.val();
        DatePicker.updateForLeads();
      },
      closeOnDateSelect: true
    });

    $('#table-date-range-to').datetimepicker({
      timepicker:false,
      format: "Y-m-d",
      onClose: function(time, $input) {
        DatePicker.table_date_range_to = $input.val();
        DatePicker.updateForLeads();
      },
      closeOnDateSelect: true
    });
  });

  Pagination.initialize();